# 制定进度计划

在学习完项目进度管理其它的过程之后，我们最后再来学习制订项目进度计划这个过程。主要的原因也是在这个过程中有非常多的工具和技术牵涉到计算相关的内容。同时也和我们之前学习过的许多内容有关联，所以就将它放到了最后再来进行学习。

## 制定进度计划的概念

制订进度计划是分析活动顺序、持续时间、资源需求和进度制约因素，创建项目进度模型的过程。制定项目进度计划是一个反复多次的过程，这里同时也体现了项目的渐进明细的特点，这一过程确定项目活动计划的开始与完成。

制订进度计划可能要求对历时估算与资源估算进行审查与修改，以便进度计划在批准之后能够当作跟踪项目绩效的基准使用。制订进度计划过程随着工作的绩效、项目管理计划的改变，以及预期的风险结果，发生或消失，或识别出新的风险而贯穿于项目的始终。

对于项目的进度计划来说，有几个时间制约因素是我们需要关注的。这些制约因素会对项目有强制性的制约，比如说老板说哪天要上线！

- 活动开始或结束的强制性日期——用来约束项目的开始时间不早于开始日期或者项目结束的时间不晚于结束日期。

- 项目发起人、客户或者其他干系人经常指定关键事件或里程碑，他们都会影响在指定日期内完成项目交付物。

其它需要关注的进度计划数据与信息还包括：里程碑、计划活动、活动属性、假设与约束因素、按时间段提出的资源需求、其他可供选择的进度计划、进度应急储备。

## 制订进度计划输出

首先就是进度基准，这个东西就是经过批准的项目进度计划。到此，我们已经知道了 范围基准 和 进度基准 。那么 项目进度计划 都包含什么呢？

项目进度计划是进度模型的输出，展示活动之间的相互关联，以及计划日期、持续时间、里程碑和所需资源。具体包括三种：

- 里程碑进度计划，也叫里程碑图。只标示出主要可交付成果和关键外部接口的计划开始或完成日期。

- 横道图。也就是我们常说的甘特图，活动列于纵轴，日期排于横轴。 常用于向管理层汇报情况使用。甘特图简单明了，直观并且易于编制，但是不是能靛复杂关系，难以定量计算和分析。

- 项目进度网络图。这个是我们后面马上要学习到的重点内容，也就是关键路径法绘制的网络图。

![./img/531.jpg](./img/531.jpg)

教材上的里程碑图和甘特图的示例。相信不少同学应该早就见过甘特图了，不管是在 Windows 下使用的微软 Project 还是在 Mac 下使用的 Omni Plan ，核心的功能都是绘制这样的甘特图。在这种图中，横条表示任务跨越的时间，菱形一般就表示为 里程碑 。连线就是表示 任务活动 之间的 逻辑关系 ，也就是我们上节课中讲过的 FS 、FF 那些。

关于制订进度计划的概念与输出的内容就是这些，下面就是整个进度管理中最为核心的内容，也就是关于项目进度网络图相关的内容。

## 关键路径法

关键路径法（CPM）是借助网络图和各活动所需时间（估计值），计算每一项活动的最早或最迟开始和结束时间。CPM算法的核心思想是将工作分解结构（WBS）分解的活动按逻辑关系加以整合，统筹计算出整个项目的工期和关键路径。

关键路径法沿着项目进度网络路线进行正向与反向分析，从而计划出所有计划活动理论上的最早开始与完成日期、最迟开始与完成日期，不考虑任何资源限制。

还记得我们在进度管理第一篇文章中看到的那个网络图吗？

![./img/514.jpg](./img/514.jpg)

在这张图中，有几个箭头线条加粗了，你能看出来这是什么意思吗？其实这加粗的线段内容就是我们所说的关键路径。对了，你还记得这个网络图每个结点的意思吗？

![./img/513.jpg](./img/513.jpg)

你可以尝试将上图各个结点路径的工期加起来，就会发现加粗的这一条路径是工期最长的。

- ABFGH：2+18+10+170+35=235

- ACFGH：2+13+10+170+35=230

- ABDEH：2+18+8+15+35=78

很明显，ABFGH 就是这条加粗的路径，这条路径在我们的网络图中表示的就是 <span style="color:red;">**“关键路径”**</span> 。 在项目管理领域，关键路径是非常重要的一条路径，其实你可以看出，关键路径决定着我们的项目的最终工期。如果关键路径上的任务延期了，那么我们的项目也极大可能会要延期。同时，我们这个网络图比较简单，关键路径是有可能不止一条的。但，反过来说，每个项目又必须要有一条关键路径。

### 关键路径法正推工期

好了，你已经清楚工期的作用了，接下来我们来看进度网络图结点中的四个角，也就是最早开始时间ES、最早完成时间EF、最迟开始时间LS和最迟完成时间LF。

最早开始时间就是我们这个活动最早可以什么时候开始。A 结点的 ES 自然是 0 ，它是整个任务的开始结点，所以我们从零开始。那么对应的它的最早完成时间 EF 就是 ES + 工期，也就是 2 。

接下来我们看结点 B 。它的最早开始时间是上一个任务的最晚完成时间，也就是 A 的 LF 。毕竟要等到 A 结束了我们才能开始 B 。在网络图中，默认都是走的 FS ，也就是完成到开始这种逻辑关系。所以 B 结点的最早开始时间是 2 ，最早完成时间是 2+18=20 。

同样地方式，我们计算出 C 结点，它的最早开始时间和 B 结点是一样的，都是从 2 开始，但是它的工期短，所以它的最早完成时间是 15 。从这里，我们就可以看到，在 B 和 C 结点中，B 结点的工期更长，C 的工期较短，如果 C 出现延误的话，对于总工期的影响不大，或者说在一定的范围内不会影响总工期。这个范围其实就是 C 比 B 少的那几天，也就是 C 最多可以晚个 5 天再开始也不会对总的工期产生影响。但如果 C 超过 5 天了，那么它的工期就超过 B 了，这样的话，它就会因为延期而成为关键路径。

按照这样的方式，我们就可以依次地推算出整个项目全部任务的 ES 和 EF ，直到最后的任务 H ，并且可以确定出我们的关键路径就是 ABFGH 这条路径。其中 F 和 H 结点是比较特殊的两个任务结点，因为它们有两个上级（紧前活动），那么 F 和 H 的 ES 怎么确定呢？这种情况下的 ES 的公式是 最大的坚前活动的 EF 就是当前这个活动的 ES 。比如 F 的紧前是 B 和 C ，最大的 EF 是 B 的 EF 20 ，那么 F 的 ES 就是 20 。

上述过程其实就是我们通过正向的方式去推算 ES 和 EF ，通过这样的步骤我们可以确定出关键路径 CPM 以及整体项目完工时间。

### 关键路径法逆推最晚完工时间

好了，剩下的 LS 、LF 和 TF 是什么呢？我们先来看 LS 和 LF 如何推算。一般来说，我们在完成了正向推算后，最后一个活动也就是 H 活动的 EF 就是总工期的完成时间，那么它的 LF 其实也是这个时间，所以我们可以确定 H 的 LF 是 235 ，而它的 LS 就是 LF-DU 也就是 200 。活动 H 的 EF=LF，ES=LS。

然后我们向前逆推，H 的前面有两个结点，分别是 E 和 G ，我们随便看一个就可以，就拿 E 为例。E 的 LF 应该是 H 的 LS ，也就是它的最晚结束时间是 H 的是最晚开始时间，E 的 LS 同样为 LF-DU ，所以 E 的 LS 最后计算的结果是 185 。

单个结点好说，我们来看一下 B 结点和 A 结点，它们都有两个后继，而逆推回来的话，它们的 LF 要怎么确定呢？LF 是最晚结束时间，也就是说，这个活动最晚结束的时候一定是要早于后续所有的最晚开始时间的。这样的话，其实 LF 的终极公式应该是 紧后活动最小的那个LS 。比如 B 结点的紧后是 D 和 F ，最小的 LS 是 F 的 20 ，那么 B 的 LF 就是 20 。

逆推完成之后，仔细看图，有没有发现一个特点，**关键路径上的 EF=LF，ES=LS** 。

### 正向与逆向步骤总结

通过正向计算，推算最早完工时间的步骤：

- 从网络图始端向终端计算

- 第一活动的项目开始，第一个活动的 ES 为 0

- 活动开始时间加持续时间

- 后续活动的开始时间根据前置活动的时间和搭接时间而定

- 多个前置活动存在时，根据最迟活动时间来定

通过反向计算，来推算出最晚完工时间：

- 从网络图终端向始端计算

- 最后一个活动的完成时间为项目完成时间

- 活动开始时间为完成时间减持续时间

- 前置活动的完成时间根据后续活动的时间和搭接时间而定

- 多个后续活动存在时，根据最早活动时间来定

### 总浮动时间与自由浮动时间

总浮动时间，也可以叫做总时差，也就是我们活动结点图中下方中间的 TF 。它表示的是在不延误项目完工时间且不违反进度制约因素前提下，活动可以从最早开始时间推迟或拖延的时间量，也就是该活动的进度灵活性。它的计算方法是本活动的最迟完成时间减去本活动的最早完成时间，或本活动的最迟开始时间减去本活动的最早开始时间。LS-ES 或 LF-EF 。很明显，**关键路径的 TF 都是 0** ，而C、D、E这三个非关键路径上结点都是有 TF 的。比较直白的说，就是这些非关键路径活动可以延误的时间，比如 C 延误在 5 天的话不会影响最后的总工期 235 天，这个 5 天就是 C 的总浮动时间（总时差）。

除了总浮动时间外，还有一个自由浮动时间的概念，它指的是在不延误任何紧后活动的最早开始时间且不违反进度制约因素的前提下，活动可以从最早开始时间推迟或拖延的时间量。自由浮动时间也可以叫做自由时差，计算方式是紧后活动最早开始时间的最小值减去本活动的最早完成时间。还是拿 C 来看，它的紧后只有一个 F ，那么它的自由时差就是 F 的 ES 20 ，减去它自己的 EF 15 ，结果是 5 。一般来说，自由时差是会小于总时差的，并且自由时差的计算也会比较少。它关注的是前后两个活动一对多的情况。自由时差一般不会在活动结点中展示出来，它的缩写是 FF .

### 公式总结

经过上面的讲解，其实我们就可以得到活动节点各个开始结束时间以及总时差和自由时差的公式。在这里我们总结一下。

- ES = max(紧前活动的EF)，也就是当前这个节点的最早开始时间是这个节点之前所有活动中最大的那个 EF 

- EF = ES + DU

- LF = min(紧后活动的LS)，这个指的是最迟完成时间的确定应该是这个节点后续的所有节点中最小的那个 LS 的值

- LS = LF - DU

- TF = LS - ES 或 LF - EF

- FF = min(紧后活动的ES) - EF 

这几个缩写代表的意思一定要明白，这几个公式也一定要熟记于心。<span style="color:red;">**重点中的重点，或者说是整个信管师学习的超级重点之一。**</span>另一个超级重点就是我们下一章节要学习的成本管理中的挣值管理的计算。每次考试的案例计算题这两种必出其一，甚至是一道题中融合这两种计算。（比如先让你算工期，也就是计算进度，然后再问你成本、进度情况，这是挣值计算的内容）。**再次提醒，每次考试必有其一！！**

## 关键链法

## 资源优化技术

## 进度压缩技术

## 例题

上面讲了那么多，如果你是没有 PMP 的基础或者第一次看的话，那么相信你和我第一次看到这里应该是一样的感觉，那就是两个字：懵逼。不要怕，不要急，光说不练假把式，我们用一个例题来说就会非常清楚了。

http://www.cnitpm.com/pm1/77498.html

## 总结

参考资料：

《信息系统项目管理师教程》

《某机构培训资料》

《项目管理知识体系指南 PMBOK》第六版